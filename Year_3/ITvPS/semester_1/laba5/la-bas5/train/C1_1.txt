Алгебра Хопфа графов
При обсуждении теневого исчисления мы выяснили, что оно тесно связано со структурой градуированной коалгебры на пространстве многочленов от одной переменной. Эта структура естественным образом распространяется и на пространство многочленов от многих переменных. В этой главе мы приводим еще один пример коалгебраической структуры на пространстве графов. Коалгебра графов также градуирована числом вершин в графе. Добавив к коумножению умножение, порожденное несвязным объединением графов, мы получаем на пространстве графов структуру биалгебры. Свойства многих инвариантов графов тесно связаны с наличием этой структуры.

Структура алгебры
Большинство из рассматривавшихся нами в предыдущих лекциях инвариантов графов являются мультипликативными: их значение на несвязном объединении графов равно произведению их значений на каждом из объединяемых графов. Тот факт, что это свойство присуще большому количеству интересных инвариантов, навел Татта на мысль рассматривать несвязное объединение графов как умножение в кольце, а  мультипликативные инварианты как гомоморфизм колец. Из соображений удобства языка мы будем брать в качестве базового кольца поле C комплексных чисел (а не кольцо целых чисел Z) и говорить об алгебре графов над полем C.
Определение 9.1.1. Алгеброй графов G называется бесконечномерная алгебра с единицей над R, порожденная как алгебра простыми связными графами, умножение образующих в которой задается несвязным объединением графов.
Напомним, что простой граф не содержит петель и кратных ребер.

Взвешенные графы
Расставим в вершинах простого графа натуральные числа веса вершин. Такой граф будем называть взвешенным. Весом графа называется сумма весов всех его вершин. Рассмотрим конечномерные пространства WGn, порожденные графами веса n. Их прямая сумма наделена структурой градуированной биалгебры. И умножение, и коумножение задаются, как и в случае обычных графов.
Введем следующее отношение эквивалентности на множестве взвешенных графов
где e произвольное ребро взвешенного графа ?. Это соотношение полностью совпадает с соотношением Татта, однако в нем операция стягивания ребра ? > ? имеет другой смысл. При стягивании ребра появившиеся кратные ребра заменяются однократными, а вес новой вершины полагается равным сумме весов тех вершин, из которых она образовалась. В результате соотношение (9.5) становится однородным: веса всех трех входящих в него графов одинаковы. Факторизуя биалгебру WG по соотношениям (9.5), мы получаем новую биалгебру
Утверждение о том, что W действительно является градуированной коммутативной кокоммутативной биалгеброй мы оставляем в качестве упражнения.
Покажем теперь, что взвешенные графы попали в этот раздел не зря: биалгебра W является факторбиалгеброй биалгебры G. Для этого определим гомоморфизм G > WG, сопоставив каждому графу тот же взвешенный граф с весами всех вершин равными 1. Мы хотим показать, что композиция этого гомоморфизма с факторизацией по модулю соотношений (9.5) является эпиморфизмом биалгебр, а значит W действительно является фактор биалгеброй биалгебры G.
Начнем с доказательства структурной теоремы для биалгебры W, аналогичной теореме Татта.
Теорема 9.3.3. Биалгебра W изоморфна биалгебре многочленов C[s1,s2,...], градуированной присвоением переменной si веса i, w(si) = i. Доказательство. Как и в ситуации с соотношением Татта, каждый граф эквивалентен в W линейной комбинации графов без ребер: в правой части соотношения (9.5) стоят графы с меньшим числом ребер, чем в левой части. Каждый взвешенный граф без ребер является несвязным объединением вершин некоторого веса. Сопоставив вершине веса i переменную si, мы сопоставляем графу веса n некоторый взвешенно-однородный многочлен веса n от переменных si. Единственное, что осталось доказать это то, что сопоставление корректно определено. Это достигается указанием универсального инварианта.
Здесь суммирование идет по всем остовным подграфам графа, т.е. по всевозможным подмножествам в E(?), произведение берется по всем связным компонентам ?i графа ?, а ?1(?i) – цикломатическое число графа.
Например, значение инварианта W на треугольнике C3 с весами вершин a,b,c равно.
Очевидно, что на одновершинном графе с вершиной веса n функция W принимает значение sn. Проверку того, что W удовлетворяет соотношениям (9.5) и определяет, тем самым, линейный функционал на W, мы оставляем читателям.
Для доказательства того, что построенный гомоморфизм G > W является эпиморфизмом, осталось проверить, что одновершинный граф произвольного веса n лежит в образе этого гомоморфизма. Для этого достаточно взять образ ?n(An) проекции на примитивные элементы графа-цепочки с n вершинами.
Утверждение 9.3.4. Гомоморфизм биалгебры графов в биалгебру взвешенных графов по модулю соотношений (9.5) пропускается через 4-биалгебру графов, т.е. существует цепочка эпиморфизмов G > F > W. Доказательство Нам достаточно доказать существование только второго гомоморфизма. В биалгебре взвешенных графов каждая из разностей в левой и правой частях 4-членного соотношения эквивалентна графу со стянутым ребром AB. Нетрудно видеть, что эти два графа совпадают, причем вес новой вершины в обоих случаях равен 2.
Утверждение доказано.

4-инварианты
Построенный универсальный инвариант взвешенных графов полностью описывает структуру биалгебры взвешенных графов и все мультипликативные линейные функционалы на ней. Однако ситуация с 4-биалгеброй обстоит не так просто. Причина этого в том, что 4-членное соотношение не позволяет упростить каждый граф: графы могут иметь, скажем, одинаковое число ребер. В результате у нас нет нетавтологического описания двойственной биалгебры F – биалгебры 4-инвариантов. Поэтому особый интерес вызывает построение отдельных примеров и серий примеров 4-инвариантов. Мы будем определять 4-инварианты их значениями на графах, подразумевая что на линейные комбинации графов они продолжаются по линейности.
Пример 9.4.1 (хроматический многочлен). Согласно наблюдению С. В. Дужина, хроматический многочлен является 4-инвариантом. Для проверки
этого достаточно заметить, как мы сделали это в доказательстве утверждения 9.3.4, что в результате стягивания ребра AB в графах ? и ?AB мы получаем, после замены кратных ребер однократными, одинаковые графы.
Впрочем, хроматический многочлен – по существу единственный из инвариантов Татта, являющийся одновременно 4-инвариантом.
Пример 9.4.2 (вершинные четырехугольники). Назовем вершинным четырехугольником в графе набор из четырех вершин, таких что при некотором циклическом порядке (i,j,k,l) на множестве индексов в графе есть ребра.
Тогда число Q (?) вершинных четырехугольников в графе ? является 4-инвариантом.
Это утверждение можно проверить для четырехчленного соотношения
на рис. 9.3: оба графа в левой его части содержат по единственному вершинному четырехугольнику, тогда как в графах в правой части таких четырехугольников нет.
Для его доказательства можно сначала проверить его на всех графах с четырьмя вершинами. Обозначим теперь через Q инвариант графов, равный числу вершинных четырехугольников на всех графах с четырьмя вершинами и нулю на всех остальных графах. Рассмотрим также графовый инвариант U, тождественно равный 1 на всех графах. Очевидно, что и функция Q , и функция U, являются 4-инвариантами. Поэтому их произведение свертки Q U тоже является 4-инвариантом. Непосредственная проверка показывает, что Q U = Q . Очевидно также, что этот инвариант мультипликативен.
Можно проверить, что Q является 4-инвариантом, и непосредственно.
Разность значений этой функции на слагаемых в левой (соотв., правой) части 4-членного соотношения равна числу таких вершинных прямоугольников, что соответствующий им набор ребер обязательно содержит ребро AB. Но, как нетрудно видеть, между такими прямоугольниками существует естественное взаимно однозначное соответствие. Приведенный пример является частным случаем следующего общего утверждения:
Утверждение 9.4.3. Если инвариант графов с n вершинами, то функция, где суммирование идет по всем n-вершинным подмножествам множества, является 4-инвариантом графов.
Замечание 9.4.4 (сложность вычисления). Инварианты описанного в этом утверждении типа, принимающие нулевое значение на несвязных графах, полиномиально вычислимы (что бы это ни значило). При фиксированном значении n сложность их вычисления растет пропорционально |V(?)|. Действительно, для их вычисления нужно проанализировать не все n-вершинные подграфы графа, а лишь все окрестности радиуса n каждой из его вершин.

Реберным четырехугольником в графе  называется набор e1,e2,e3,e4 различных ребер графа, образующих замкнутый путь в нем. Число реберных четырехугольников не является 4-инвариантом, однако взятое по модулю 2 оно становится 4-инвариантом. 

Например, в первом графе в левой части рис. 9.3 три реберных четырехугольника, во втором такой четырехугольник один, а в графах в правой части их вообще нет.
То же самое утверждение справедливо и для числа реберных n-угольников для любого n. Действительно, обозначим через Ek число реберных k-угольников в ?. Применяя эту функцию к обеим частям 4-членного соотношения, мы получим, что в правой (соотв., левой) его части стоит число реберных k-угольников в ? (соотв., в ?AB), содержащих ребро AB.

Во всяком таком k-угольнике есть цепочка CABD, и мы можем выделить три типа цепочек в зависимости от того, как C примыкает к B, а D примыкает к A:
• C примыкает к B, а D примыкает к A;
• C примыкает к B, а D не примыкает к A;
• C не примыкает к B.
Реберные k-угольники, принадлежащие ко второму классу, находятся во взаимно-однозначном соответствии с k-угольниками в ?AB, содержащими путь CBAD. Реберные k-угольники третьего типа одинаковы в обоих графах. Наконец, реберные k-угольники первого типа разбиваются на пары: цепь CABD можно заменить цепью CBAD. Таким образом, число реберных k-угольников первого типа четно в обоих графах, и утверждение доказано.
Пример 9.4.6 (совершенные паросочетания). Число совершенных паросочетаний в графе является 4-инвариантом. Проверку этого утверждения мы оставляем читателю в качестве упражнения. Заметим, однако, что это не слишком мощный инвариант, так как он является экспонентой следующего очень простого 4-инварианта. Если мы положим m(?) равным 1 на графе с двумя вершинами и одним ребром, и 0 на всех остальных графах, то число совершенных паросочетаний дается экспонентой.
Умножение здесь понимается в смысле умножения свертки.
Пример 9.4.7 (коранг матрицы примыканий). Если мы занумеруем произвольным образом вершины графа, то мы можем сопоставить ему матрицу примыканий размера. На пересечении i-ой строки и j-го столбца этой матрицы стоит 1, если i-ая и j-ая вершина соединены ребром, и 0 в противном случае. На диагонали матрицы стоят нули.
Матрица примыканий симметрична. Мы рассматриваем элементы этой матрицы как элементы кольца Z2. Тогда коранг матрицы примыканий является 4-инвариантом. Разумеется, это утверждение справедливо и для ее ранга, однако в дальнейшем нам понадобится именно коранг. Доказательство основано на том, что коранг матрицы примыканий графа не меняется при переходе от C к AB.
