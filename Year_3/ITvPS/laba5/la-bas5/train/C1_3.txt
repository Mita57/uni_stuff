Элементы теории графов 
 
Графы являются существенным элементом математических моделей в самых разнообразных областях науки и практики. Они помогают наглядно  представить  взаимоотношения  между  объектами  или  событиями  в сложных системах. Многие алгоритмические задачи дискретной математики могут быть сформулированы как задачи, так или иначе связанные с графами,  например  задачи,  в  которых  требуется  выяснить  какие-либо особенности устройства графа или найти в графе часть, удовлетворяющую некоторым требованиям, или построить граф с заданными свойствами. 
Настоящая глава является кратким введением в теорию графов. В ней приводится минимум понятий, необходимый для того, чтобы можно было начать какую-либо содержательную работу с графами или приступить к более глубокому изучению теории графов. Доказательства даются только в тех случаях, когда их сложность не превышает некоторого интуитивно ощущаемого порога. Поэтому, например, такие важные факты, как теорема Кирхгофа или теорема Понтрягина – Куратовского, сообщаются без 
доказательств.
 
Определение графа 
 
Для описания строения различных систем, состоящих из связанных между собой элементов, часто используют графические схемы, изображая элементы точками (кружками, прямоугольниками и т.д.), а связи между ними – линиями или стрелками, соединяющими элементы. При этом получаются диаграммы вроде тех, что показаны на рис. 1.1. На  таких  диаграммах  часто  ни  способ  изображения  элементов, ни форма или длина линий не имеют значения – важно лишь, какие именно пары элементов соединены линиями. Если посмотреть внимательно, то можно заметить, что рис. 1.1,а и 1.1,б изображают одну и ту же структуру связей между элементами A, B, C, D, E, F. Эту же структуру можно описать, не прибегая к графическому изображению, а просто перечислив пары связанных между собой элементов: (A, B), (A, D), (B, C), (B, E), (B, F), (C, F), (D, E). Таким образом, когда мы отвлекаемся от всех несущественных подробностей, у нас остаются два списка: список элементов и список пар элементов. Вместе они составляют то, что математики называют графом. Из этого примера видно, что понятие графа само по себе не связано прямо с геометрией или графикой. Тем не менее возможность нарисовать граф – одна из привлекательных черт этого математического объекта. 
 Термин «граф» неоднозначен, это легко обнаружить, сравнивая приводимые в разных книгах определения графа. Однако во всех этих определениях есть и общее. В любом случае граф состоит из двух множеств – множества вершин и множества ребер, причем для каждого ребра указана пара вершин, которые это ребро соединяет. Вершины и ребра называются элементами графа. Здесь будут рассматриваться только конечные графы, то есть такие, у которых оба множества конечны. Чтобы получить законченное определение графа того или иного типа, необходимо уточнить еще следующие три момента. 

1. Ориентированный или неориентированный? Прежде всего, нужно договориться, считаем ли мы пары (a, b) и (b, a) различными. Если да, то говорят, что рассматриваются упорядоченные пары (порядок элементов в паре важен), если нет – неупорядоченные. Если ребро e соединяет вершину a с вершиной b и пара (a, b) считается упорядоченной, то это ребро называется ориентированным, вершина a – его началом, вершина b – концом. Если же эта пара считается неупорядоченной, то ребро называется неориентированным, а обе вершины – его концами. Чаще всего рассматривают графы, в которых все ребра имеют один тип – либо ориентированные, либо неориентированные. В соответствии с этим и весь граф называют ориентированным или неориентированным. На рисунках ориентацию ребра (направление от начала к концу) указывают стрелкой. На рис.1.1 показаны неориентированные графы, а на рис. 1.2 – ориентированные.
2. Кратные ребра. Следующий пункт, требующий уточнения, – могут ли разные ребра иметь одинаковые начала и концы? Если да, то говорят, что в графе допускаются кратные ребра. Граф с кратными ребрами называют также мультиграфом. На рис. 1.2 изображены два графа, левый является  ориентированным  мультиграфом,  а  правый –  ориентированным графом без кратных ребер. 
3. Петли. Ребро, которому поставлена в соответствие пара вида (a, a), то есть ребро, соединяющее вершину a с нею же самой, называется петлей. Если такие ребра не допускаются, то говорят, что рассматриваются графы без петель. 

Комбинируя эти три признака, можно получить разные варианты определения понятия графа. Особенно часто встречаются неориентированные графы без петель и кратных ребер. Такие графы называют обыкновенными. Если в графе нет кратных ребер, то можно просто отождествить  ребра с соответствующими парами вершин – считать, что ребро это и есть пара вершин. Чтобы исключить петли, достаточно оговорить, что вершины, образующие ребро, должны быть различны. Это приводит к следующему определению обыкновенного графа. 
Определение. Обыкновенным графом называется пара G = (V, E), где V – конечное множество, E – множество неупорядоченных пар различных элементов из V. Элементы множества V называются вершинами графа, элементы множества E – его ребрами. 
Слегка модифицируя это определение, можно получить определения других типов графов без кратных ребер: если заменить слово «неупорядоченных»  словом «упорядоченных»,  получится  определение  ориентированного графа без петель, если убрать слово «различных», получится определение графа с петлями. Ориентированный граф часто называют орграфом. 
В дальнейшем термин «граф» будем употреблять в смысле «обыкновенный граф», а рассматривая другие типы графов, будем специально это оговаривать.
Множество вершин графа G будем обозначать через VG, множество ребер – EG, число вершин – n(G), число ребер – m(G). 
Из определения видно, что для задания обыкновенного графа достаточно  перечислить  его  вершины  и  ребра,  причем  каждое  ребро  должно быть парой вершин. Положим, например, VG = {a, b, c, d, e, f  }, EG = {(a, c), (a, f ), (b, c), (c, d), (d, f )}. Тем самым задан граф G с n(G) = 6, m(G) = 5. Если граф не слишком велик, то более наглядным способом представить его является рисунок, на котором вершины изображаются кружками или иными значками, а ребра – линиями, соединяющими вершины. Заданный выше граф G показан на рис. 1.3. Мы будем часто пользоваться именно этим способом представления графа, при этом обозначения вершин иногда будут помещаться внутри кружков, изображающих вершины, иногда рядом с ними, а иногда, когда имена вершин несущественны, и вовсе опускаться.

Взвешенные графы 

Часто, особенно когда графы используются для моделирования реальных систем, их вершинам или ребрам, или и тем и другим приписываются некоторые числа. Природа этих чисел может быть самая разнообразная. Например, если граф представляет собой модель железнодорожной сети, то число, приписанное ребру, может указывать длину перегона между двумя станциями или наибольший вес состава, который допустим для этого участка пути, или среднее число поездов, проходящих через этот участок в течение суток и т.п. Что бы ни означали эти числа, сложилась традиция называть их весами, а граф с заданными весами вершин и/или ребер – взвешенным графом.  
 

Определение изоморфизма 
 
На рис. 1.8 изображены два графа с одним и тем же множеством вершин {a, b, c, d}. При внимательном рассмотрении можно обнаружить, что это разные графы – в левом имеется ребро (a, c), в правом же такого нет. 
В то же время, если не обращать внимания на наименования вершин, то эти графы явно одинаково устроены: каждый из них – цикл из четырех вершин. Во многих случаях при исследовании строения графов имена или номера вершин не играют роли, и такие графы, один из которых получается из другого переименованием вершин, удобнее было бы считать одинаковыми. Для того чтобы это можно было делать «на законном основании», вводится понятие изоморфизма графов.
Определение. Графы называются изоморфными, если существует такая биекция множества на множество что тогда и только тогда, когда. Отображение в этом случае называется изоморфизмом графа на граф.
Сформулированное определение изоморфизма годится и для ориентированных графов, нужно только обе упоминаемые в нем пары вершин считать упорядоченными. 
Изоморфизм – бинарное отношение на множестве графов. Очевидно, это отношение рефлексивно, симметрично и транзитивно, то есть является отношением эквивалентности. Классы эквивалентности называются абстрактными  графами.  Когда  говорят,  что  рассматриваются  абстрактные графы, это означает, что изоморфные графы считаются одинаковыми. Абстрактный граф можно представлять себе как граф, у которого стерты имена (пометки) вершин, поэтому абстрактные графы иногда называют также непомеченными. 

Инварианты 

В общем случае узнать, изоморфны ли два графа, достаточно сложно. Если буквально следовать определению, то нужно перебрать все биекции множества вершин одного из них на множество вершин другого и для каждой из этих биекций проверить, является ли она изоморфизмом. Для n вершин  имеется  n!  биекций  и  эта  работа  становится  практически  невыполнимой уже для не очень больших n (например, 20! > 2?10 ). Однако во многих случаях бывает довольно легко установить, что два данных графа  неизоморфны. 
Так как при изоморфизме пара смежных вершин переходит в пару смежных, а пара несмежных – в пару несмежных, то ясно, что число ребер у  двух  изоморфных  графов  должно  быть  одинаковым.  Поэтому  сразу можно сказать, что графы G1 и G2, у которых разное количество ребер, неизоморфны. У графов G1 и G3 одинаковое число ребер, но они тоже неизоморфны. Это можно установить, сравнивая степени вершин.